# 클래스와 멤버의 접근 권한을 최소화하라



## 캡슐화

잘 설계된 컴포넌트는 클래스 내부 데이터와 내부 구현 정보를 외부 컴포넌트로부터 얼마나 잘 숨겼느냐에 달려있다.

잘 설계된 컴포넌트는 모든 내부 구현을 완벽히 숨겨, 구현과 API를 깔끔히 분리한다. 오직 API를 통해서만

다른 컴포넌트와 소통하며 서로의 내부 동작 방식에는 전혀 개의치않는다.



## 정보은닉, 캡슐화의 장점

1. 시스템 개발 속도를 높인다. 여러 컴포넌트를 병렬로 개발할 수 있기 때문이다.

2. 시스템 관리 비용을 낮춘다. 각 컴포넌트를 더 빨리 파악하여 디버깅가능케한다.

3. 성능 최적화에 도움을 준다. 다른 컴포넌트에 영향을 주지 않고 해당 컴포넌트만 최적화할 수 있기 때문이다.

4. 소프트웨어 재사용성을 높인다. 외부에 거의 의존하지 않고 독자적인 컴포넌트라면 유용하게 쓰일 수 있다.

5. 큰 시스템을 제작하는 난이도를 낮춰준다. 시스템 전체가 아직 완성되지 않은 상태에서도 개별 컴포넌트의 동작을

    검증할 수 있기 때문이다.

**모든 클래스와 멤버의 접근성을 가능한 한 좁혀야 한다.**

즉, 소프트웨어가 올바로 동작하는 한 항상 가장 낮은 접근 수준을 부여해야 한다.



## 접근 지정자의 종류

- private

  - 멤버를 선언한 톱레벨 클래스에서만 접근할 수 있다.

- Package-private

  - 멤버가 소속된 패키지 안의 모든 클래스에서 접근할 수 있다. 접근 제한자를 지정하지 않았을 때 적용되는 패키지

    접근 수준이다.

  - 단, 인터페이스의 멤버는 기본적으로 Public이 적용된다.

- protected

  - Package-private의 접근 범위를 포함하며, 이 멤버를 선언한 클래스의 하위 클래스에서도 접근할 수 있다.

- public

  - 모든 곳에서 접근할 수 있다. 즉, 공개 API



## 컴포넌트 설계법

- 클래스의 공개 API를 세심히 설계후, 그 외의 모든 멤버는 private으로 만들라.

  - 오직 같은 패키지의 다른 클래스가 접근해야 하는 멤버에 한하여 package-private

- 코드를 테스트하려는 목적으로 클래스, 인터페이스, 멤버의 접근 범위를 넓히려 할때, private를 package-private

  까지만, 풀어주자. 그 이상은 안된다. 즉, 테스트를 위해 클래스 , 인터페이스, 멤버를 공개API로 만들지 마라.

  테스트 코드를 테스트 대상과 같은 패키지에 두면 package-private요소에 접근 할 수 있기때문.

- Public 클래스의 인스턴스 필드는 되도록 public이 아니어야 한다.

  그 필드에 담을 수 있는 값을 제한할 힘을 잃게 된다. 여기에 필드가 수정될 때 다른 작업을 할 수 없게 되므로

  public 가변필드를 갖는 클래스는 일반적으로 스레드 안전하지 않다.

- Public static final필드는 기본타입이나 불변 객체를 참조해야 한다.

~~~java
private static final Thing[] PRIVATE_VALUES = {...};
public static final List<Thing> VALUES = 
  Collections.unmodifiableList(Arrays.asList(PRIVATE_VALUES));
// 1. public 배열을 private으로 만들고 public 불변 리스트를 추가하는것
~~~

~~~Java
private static final Thing[] PRIVATE_VALUES = {...};
public static final Thing[] values() {
  return PRIVATE_VALUES.clone();
}
// 2. 배열을 private으로 만들고, 그 복사본을 반환하는 public 메서드를 추가하는 방법
~~~



